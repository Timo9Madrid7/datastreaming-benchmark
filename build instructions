# Clean rebuild
rm -rf build 

cmake --preset=windows-vcpkg
cmake --build build


# To test: in two separate terminals run the following commands
build\technologies\zeromq\ZeroMQConsumerTest.exe
build\technologies\zeromq\ZeroMQPublisherTest.exe


# To build the base image
docker build -f core\Dockerfile.base -t core_base .
docker build -f technologies\zeromq\Dockerfile.ZeroMQ -t zeromq_p2p_base .
docker build -f technologies\zeromq\Dockerfile.ZeroMQPublisher -t zeromq_p2p_publisher .
docker build -f technologies\zeromq\Dockerfile.ZeroMQConsumer -t zeromq_p2p_consumer .

# To create a docker network
docker network create benchmark-net

# To build container and explore its files
# use a container with an entrypoint in the filesystem, e.g.: zeromq-image 
docker create -it --name inspect_files_zmq --network benchmark-net zeromq-image
docker start -ai 

# To create a container and start it
docker run --name publisher --network benchmark-net zeromq-publisher

# To create a container with an entrypoint (a shell, for example) different than specified in its Dockerfile
docker run -it --entrypoint /bin/bash zeromq-consumer 

# We are using the orchestrator_env conda environment for the orchestrator 